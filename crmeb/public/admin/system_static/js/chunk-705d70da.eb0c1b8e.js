(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-705d70da"],{"4e82":function(t,e,a){"use strict";var i=a("23e7"),r=a("e330"),o=a("59ed"),s=a("7b0b"),n=a("07fa"),c=a("083a"),m=a("577e"),l=a("d039"),d=a("addb"),u=a("a640"),f=a("04d1"),p=a("d998"),_=a("2d00"),h=a("512ce"),v=[],D=r(v.sort),b=r(v.push),g=(a=l((function(){v.sort(void 0)})),r=l((function(){v.sort(null)})),u=u("sort"),!l((function(){if(_)return _<70;if(!(f&&3<f)){if(p)return!0;if(h)return h<603;for(var t,e,a,i="",r=65;r<76;r++){switch(t=String.fromCharCode(r),r){case 66:case 69:case 70:case 72:e=3;break;case 68:case 71:e=4;break;default:e=2}for(a=0;a<47;a++)v.push({k:t+a,v:e})}for(v.sort((function(t,e){return e.v-t.v})),a=0;a<v.length;a++)t=v[a].k.charAt(0),i.charAt(i.length-1)!==t&&(i+=t);return"DGBEFHACIJK"!==i}})));i({target:"Array",proto:!0,forced:a||!r||!u||!g},{sort:function(t){void 0!==t&&o(t);var e=s(this);if(g)return void 0===t?D(e):D(e,t);for(var a,i,r=[],l=n(e),u=0;u<l;u++)u in e&&b(r,e[u]);for(d(r,(i=t,function(t,e){return void 0===e?-1:void 0===t?1:void 0!==i?+i(t,e)||0:m(t)>m(e)?1:-1})),a=n(r),u=0;u<a;)e[u]=r[u++];for(;u<l;)c(e,u++);return e}})},6652:function(t,e,a){},"6da28":function(t,e,a){"use strict";a.r(e);var i=a("c7eb"),r=a("1da1"),o=a("5530"),s=(a("a9e3"),a("4e82"),a("14d9"),a("4ec9"),a("d3b7"),a("3ca3"),a("ddb0"),a("4de4"),a("99af"),a("159b"),a("a434"),a("2f62")),n=a("c4ad"),c=a("b7be"),m=a("c4c8");n={name:"storeCouponCreate",components:{goodsList:n.default},data:function(){return{disabled:!1,formData:{coupon_title:"",coupon_price:0,type:0,use_min_price:0,coupon_time:0,start_use_time:0,end_use_time:0,start_time:0,end_time:0,receive_type:1,is_permanent:1,total_count:1,sort:0,status:1,product_id:"",category_id:0,receive_limit:1},categoryList:[],productList:[],isMinPrice:0,isCouponTime:1,isReceiveTime:0,modals:!1,datetime1:["2023-10-18 00:00:00","2023-11-22 00:00:00"],datetime2:[]}},computed:Object(o.a)(Object(o.a)({},Object(s.d)("media",["isMobile"])),{},{isEdit:function(){return!!this.$route.params.edit}}),created:function(){this.getCategoryList(),this.$route.params.id&&(this.formData.id=this.isEdit&&Number(this.$route.params.id)||0,this.getCouponDetail())},methods:{getCategoryList:function(){var t=this;Object(m.d)(1).then(function(){var e=Object(r.a)(Object(i.a)().mark((function e(a){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.categoryList=a.data;case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},getCouponDetail:function(){var t=this;Object(c.o)(this.$route.params.id).then((function(e){e=e.data,t.formData.coupon_title=e.coupon_title,t.formData.type=e.type,t.formData.category_id=e.category_id,t.formData.coupon_price=parseFloat(e.coupon_price),t.formData.use_min_price=parseFloat(e.use_min_price),t.formData.use_min_price&&(t.isMinPrice=1),t.formData.coupon_time=e.coupon_time,t.formData.receive_type=e.receive_type,t.formData.is_permanent=e.is_permanent,t.formData.status=e.status,t.formData.product_id=e.product_id,t.formData.start_time=e.start_time,t.formData.end_time=e.end_time,t.formData.total_count=e.total_count,t.formData.sort=e.sort,t.formData.receive_limit=e.receive_limit,"productInfo"in e&&(t.productList=e.productInfo),e.coupon_time||(t.isCouponTime=0,t.datetime1=[t.makeDate(1e3*e.start_use_time),t.makeDate(1e3*e.end_use_time)],t.formData.start_use_time=t.makeDate(1e3*e.start_use_time),t.formData.end_use_time=t.makeDate(1e3*e.end_use_time)),e.start_time&&(t.isReceiveTime=1,t.datetime2=[1e3*e.start_time,1e3*e.end_time],t.formData.start_time=t.makeDate(1e3*e.start_time),t.formData.end_time=t.makeDate(1e3*e.end_time))})).catch((function(e){t.$message.error(e.msg)}))},makeDate:function(t){return t=new Date(t),t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())+" "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())},save:function(){var t=this;if(!this.formData.coupon_title)return this.$message.error("请输入优惠券名称");if(2===this.formData.type&&!this.formData.product_id)return this.$message.error("请选择商品");if(1===this.formData.type&&!this.formData.category_id)return this.$message.error("请选择品类");if(this.formData.coupon_price<=0)return this.$message.error("优惠券面值不能小于0");if(this.isMinPrice){if(this.formData.use_min_price<1)return this.$message.error("优惠券最低消费不能小于0")}else this.formData.use_min_price=0;if(this.isCouponTime){if(this.formData.start_use_time=0,this.formData.end_use_time=0,this.formData.coupon_time<1)return this.$message.error("使用有效期限不能小于1天")}else if(this.formData.coupon_time=0,!this.formData.start_use_time)return this.$message.error("请选择使用有效期限");if(this.isReceiveTime){if(!this.formData.start_time)return this.$message.error("请选择领取时间")}else this.formData.start_time=0,this.formData.end_time=0;if(2!=this.formData.receive_type&&3!=this.formData.receive_type||(this.formData.is_permanent=1),this.formData.is_permanent)this.formData.total_count=0;else if(this.formData.total_count<1)return this.$message.error("发布数量不能小于1");if(this.formData.receive_limit<1)return this.$message.error("每个用户可以领取数量不能小于1");0==this.formData.type?(this.formData.product_id="",this.formData.category_id="",this.productList=[]):1==this.formData.type?(this.formData.product_id="",this.productList=[]):2==this.formData.type&&(this.formData.category_id=""),this.disabled||(this.disabled=!0,Object(c.r)(this.formData).then((function(e){t.$message.success(e.msg),setTimeout((function(){t.disabled=!1,t.$router.push({path:t.$routeProStr+"/marketing/store_coupon_issue/index"})}),1e3)})).catch((function(e){t.disabled=!1,t.$message.error(e.msg)})))},dateChange:function(t){this.formData.start_use_time=t[0],this.formData.end_use_time=t[1]},timeChange:function(t){this.formData.start_time=t[0],this.formData.end_time=t[1]},unique:function(t){var e=new Map;return t.filter((function(t){return!e.has(t.product_id)&&e.set(t.product_id,1)}))},getProductId:function(t){var e=this;this.modals=!1,this.productList=this.unique(this.productList.concat(t)),this.formData.product_id="",this.productList.forEach((function(t){e.formData.product_id?e.formData.product_id+=",".concat(t.product_id):e.formData.product_id+="".concat(t.product_id)}))},cancel:function(){this.modals=!1},remove:function(t){for(var e=this,a=0;a<this.productList.length;a++)this.productList[a].product_id==t&&this.productList.splice(a,1);this.formData.product_id="",this.productList.forEach((function(t){e.formData.product_id?e.formData.product_id+=",".concat(t.product_id):e.formData.product_id+="".concat(t.product_id)}))}}},a("dd50"),o=a("2877"),s=Object(o.a)(n,(function(){var t=this,e=t._self._c;return e("div",[e("pages-header",{ref:"pageHeader",attrs:{title:t.$route.params.id?"编辑优惠券":"添加优惠券",backUrl:t.$routeProStr+"/marketing/store_coupon_issue/index"}}),e("el-card",{staticClass:"mt16",attrs:{bordered:!1,shadow:"never"}},[e("el-form",{attrs:{model:t.formData,"label-width":"160px"}},[e("el-form-item",{attrs:{label:"优惠券名称："}},[e("el-input",{staticClass:"content_width",attrs:{maxlength:18,placeholder:"请输入优惠券名称"},model:{value:t.formData.coupon_title,callback:function(e){t.$set(t.formData,"coupon_title",e)},expression:"formData.coupon_title"}})],1),e("el-form-item",{attrs:{label:"优惠券面值："}},[e("el-input-number",{staticClass:"content_width",attrs:{controls:!1,min:1,max:9999999999,disabled:t.isEdit},model:{value:t.formData.coupon_price,callback:function(e){t.$set(t.formData,"coupon_price",e)},expression:"formData.coupon_price"}})],1),e("el-form-item",{attrs:{label:"发送方式："}},[e("el-radio-group",{attrs:{disabled:t.isEdit},model:{value:t.formData.receive_type,callback:function(e){t.$set(t.formData,"receive_type",e)},expression:"formData.receive_type"}},[e("el-radio",{attrs:{label:1}},[t._v("用户领取")]),e("el-radio",{attrs:{label:2}},[t._v("新用户自动发放")]),e("el-radio",{attrs:{label:3}},[t._v("系统赠送")]),e("el-radio",{attrs:{label:4}},[t._v("付费会员专享")])],1),e("div",{staticClass:"tip"},[t._v("\n          用户领取：用户需要手动领取优惠券；"),e("br"),t._v("\n          新用户自动发放：新注册的用户自动发放；"),e("br"),t._v("\n          系统赠送：后台发放指定用户或者添加到商品里面用户购买该商品获得；"),e("br"),t._v("\n          付费会员专享：仅付费会员可以领取和使用\n        ")])],1),e("el-form-item",{attrs:{label:"优惠劵类型："}},[e("el-radio-group",{attrs:{disabled:t.isEdit},model:{value:t.formData.type,callback:function(e){t.$set(t.formData,"type",e)},expression:"formData.type"}},[e("el-radio",{attrs:{label:0}},[t._v("通用券")]),e("el-radio",{attrs:{label:1}},[t._v("品类券")]),e("el-radio",{attrs:{label:2}},[t._v("商品券")])],1)],1),e("el-form-item",{directives:[{name:"show",rawName:"v-show",value:2===t.formData.type,expression:"formData.type === 2"}]},[[e("div",{staticClass:"acea-row"},[t._l(t.productList,(function(a,i){return e("div",{key:i,staticClass:"pictrue"},[e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:a.image,expression:"item.image"}]}),e("i",{staticClass:"el-icon-error btndel",on:{click:function(e){return t.remove(a.product_id)}}})])})),e("div",{staticClass:"upLoad acea-row row-center-wrapper",on:{click:function(e){t.modals=!0}}},[e("i",{staticClass:"el-icon-goods",staticStyle:{"font-size":"24px"}})])],2)]],2),e("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1===t.formData.type,expression:"formData.type === 1"}]},[e("el-cascader",{staticStyle:{width:"320px"},attrs:{size:"small",options:t.categoryList,props:{multiple:!0,emitPath:!1,checkStrictly:!0},clearable:"",disabled:t.isEdit},model:{value:t.formData.category_id,callback:function(e){t.$set(t.formData,"category_id",e)},expression:"formData.category_id"}}),e("div",{staticClass:"info"},[t._v("选择商品的品类")])],1),e("el-form-item",{attrs:{label:"使用门槛："}},[e("el-radio-group",{attrs:{disabled:t.isEdit},model:{value:t.isMinPrice,callback:function(e){t.isMinPrice=e},expression:"isMinPrice"}},[e("el-radio",{attrs:{label:0}},[t._v("无门槛")]),e("el-radio",{attrs:{label:1}},[t._v("有门槛")])],1)],1),t.isMinPrice?e("el-form-item",[e("el-input-number",{staticClass:"content_width",attrs:{controls:!1,min:0,max:9999999999,disabled:t.isEdit},model:{value:t.formData.use_min_price,callback:function(e){t.$set(t.formData,"use_min_price",e)},expression:"formData.use_min_price"}}),e("div",{staticClass:"info"},[t._v("填写优惠券的最低消费金额")])],1):t._e(),e("el-form-item",{attrs:{label:"使用时间："}},[e("el-radio-group",{attrs:{disabled:t.isEdit},model:{value:t.isCouponTime,callback:function(e){t.isCouponTime=e},expression:"isCouponTime"}},[e("el-radio",{attrs:{label:1}},[t._v("天数")]),e("el-radio",{attrs:{label:0}},[t._v("时间段")])],1)],1),e("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.isCouponTime,expression:"isCouponTime"}],attrs:{label:""}},[e("el-input-number",{staticClass:"content_width",attrs:{controls:!1,min:0,precision:0,disabled:t.isEdit},model:{value:t.formData.coupon_time,callback:function(e){t.$set(t.formData,"coupon_time",e)},expression:"formData.coupon_time"}}),e("div",{staticClass:"info"},[t._v("领取后多少天内有效")])],1),e("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!t.isCouponTime,expression:"!isCouponTime"}],attrs:{label:""}},[e("el-date-picker",{staticStyle:{width:"380px"},attrs:{disabled:t.isEdit,clearable:"",editable:!1,type:"datetimerange","value-format":"yyyy-MM-dd HH:mm:ss","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:t.dateChange},model:{value:t.datetime1,callback:function(e){t.datetime1=e},expression:"datetime1"}})],1),2!=t.formData.receive_type&&3!=t.formData.receive_type?e("el-form-item",{attrs:{label:"领取时间："}},[e("el-radio-group",{attrs:{disabled:t.isEdit},model:{value:t.isReceiveTime,callback:function(e){t.isReceiveTime=e},expression:"isReceiveTime"}},[e("el-radio",{attrs:{label:1}},[t._v("限时")]),e("el-radio",{attrs:{label:0}},[t._v("不限时")])],1)],1):t._e(),e("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.isReceiveTime,expression:"isReceiveTime"}],attrs:{label:""}},[e("el-date-picker",{staticStyle:{width:"380px"},attrs:{clearable:"",type:"datetimerange","value-format":"yyyy/MM/dd HH:mm:ss","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期",disabled:t.isEdit},on:{change:t.timeChange},model:{value:t.datetime2,callback:function(e){t.datetime2=e},expression:"datetime2"}})],1),2!=t.formData.receive_type&&3!=t.formData.receive_type?e("el-form-item",{attrs:{label:"优惠券发布数量："}},[e("el-radio-group",{attrs:{disabled:t.isEdit},model:{value:t.formData.is_permanent,callback:function(e){t.$set(t.formData,"is_permanent",e)},expression:"formData.is_permanent"}},[e("el-radio",{attrs:{label:0}},[t._v("限量")]),e("el-radio",{attrs:{label:1}},[t._v("不限量")])],1)],1):t._e(),2!=t.formData.receive_type&&3!=t.formData.receive_type?e("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!t.formData.is_permanent,expression:"!formData.is_permanent"}],attrs:{label:""}},[e("el-input-number",{staticClass:"content_width",attrs:{controls:!1,min:t.isEdit?t.formData.total_count:1,max:9999999999,precision:0},model:{value:t.formData.total_count,callback:function(e){t.$set(t.formData,"total_count",e)},expression:"formData.total_count"}}),e("div",{staticClass:"info"},[t._v("填写优惠券的发布数量")])],1):t._e(),2!=t.formData.receive_type&&3!=t.formData.receive_type?e("el-form-item",{attrs:{label:"用户领取数量："}},[e("el-input-number",{staticClass:"content_width",attrs:{controls:!1,min:t.isEdit?t.formData.receive_limit:1,max:9999999999,precision:0},model:{value:t.formData.receive_limit,callback:function(e){t.$set(t.formData,"receive_limit",e)},expression:"formData.receive_limit"}}),e("div",{staticClass:"info"},[t._v("填写每个用户可以领取多少张")])],1):t._e(),e("el-form-item",{attrs:{label:"状态："}},[e("el-radio-group",{model:{value:t.formData.status,callback:function(e){t.$set(t.formData,"status",e)},expression:"formData.status"}},[e("el-radio",{attrs:{label:1}},[t._v("开启")]),e("el-radio",{attrs:{label:0}},[t._v("关闭")])],1)],1),e("el-form-item",[e("el-button",{attrs:{type:"primary",disabled:t.disabled},on:{click:t.save}},[t._v(t._s(t.isEdit?"立即保存":"立即创建"))])],1)],1)],1),e("el-dialog",{staticClass:"paymentFooter",attrs:{visible:t.modals,title:"商品列表",width:"1000px"},on:{"update:visible":function(e){t.modals=e}}},[t.modals?e("goods-list",{ref:"goodslist",attrs:{ischeckbox:!0},on:{getProductId:t.getProductId}}):t._e()],1)],1)}),[],!1,null,"4ebe90fe",null);e.default=s.exports},dd50:function(t,e,a){"use strict";a("6652")}}]);