require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/users/visit_list/index"],{"353b":function(t,i,e){"use strict";e.r(i);var s=e("83e3"),n=e("8ac9");for(var o in n)["default"].indexOf(o)<0&&function(t){e.d(i,t,(function(){return n[t]}))}(o);e("8f71");var c=e("f0c5"),l=Object(c["a"])(n["default"],s["b"],s["c"],!1,null,null,null,!1,s["a"],void 0);i["default"]=l.exports},"83e3":function(t,i,e){"use strict";e.d(i,"b",(function(){return s})),e.d(i,"c",(function(){return n})),e.d(i,"a",(function(){}));var s=function(){var t=this,i=t.$createElement,e=(t._self._c,t.visitList.length),s=e?t.$t("共"):null,n=e?t.$t("件商品"):null,o=e&&!t.isShowChecked?t.$t("管理"):null,c=e&&t.isShowChecked?t.$t("取消"):null,l=e?t.__map(t.visitList,(function(i,e){var s=t.__get_orig(i),n=t.__map(i.picList,(function(i,e){var s=t.__get_orig(i),n=t.isShowChecked?i.id.toString():null,o=!t.isShowChecked&&i.stock<=0?t.$t("已售罄"):null,c=t.isShowChecked||i.is_show?null:t.$t("已下架");return{$orig:s,g1:n,m4:o,m5:c}}));return{$orig:s,l0:n}})):null,h=e&&t.isShowChecked?t.$t("全选"):null,a=e&&t.isShowChecked?t.$t("收藏"):null,u=e&&t.isShowChecked?t.$t("删除"):null,d=e?null:!t.visitList.length&&2==t.page,r=!e&&d?t.$t("暂无数据"):null;t.$mp.data=Object.assign({},{$root:{g0:e,m0:s,m1:n,m2:o,m3:c,l1:l,m6:h,m7:a,m8:u,g2:d,m9:r}})},n=[]},"8ac9":function(t,i,e){"use strict";e.r(i);var s=e("9cfa"),n=e.n(s);for(var o in s)["default"].indexOf(o)<0&&function(t){e.d(i,t,(function(){return s[t]}))}(o);i["default"]=n.a},"8f71":function(t,i,e){"use strict";var s=e("ff6a"),n=e.n(s);n.a},"9cfa":function(t,i,e){"use strict";(function(t){var s=e("4ea4");Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=e("1579"),o=e("26cb"),c=e("666f"),l=s(e("66ca")),h=e("989b"),a={components:{recommend:function(){Promise.all([e.e("common/vendor"),e.e("components/recommend/index")]).then(function(){return resolve(e("f1f8"))}.bind(null,e)).catch(e.oe)},home:function(){Promise.all([e.e("common/vendor"),e.e("components/home/index")]).then(function(){return resolve(e("03ff"))}.bind(null,e)).catch(e.oe)}},mixins:[l.default],data:function(){return{isShowChecked:0,count:0,times:[],isAllSelect:!1,hostProduct:[],loadTitle:this.$t("加载更多"),loading:!1,loadend:!1,visitList:[],limit:21,page:1,isAuto:!1,isShowAuth:!1,hotScroll:!1,hotPage:1,hotLimit:10,isItemAll:[],imgHost:h.HTTP_REQUEST_URL}},computed:(0,o.mapGetters)(["isLogin"]),onLoad:function(){this.isLogin?(this.loadend=!1,this.page=1,this.visitList=[],this.get_user_visit_list(),this.get_host_product()):(0,c.toLogin)()},onShow:function(){t.removeStorageSync("form_type_cart"),this.times=[],this.loadend=!1,this.page=1,this.visitList=[],this.get_user_visit_list()},methods:{goDetails:function(i){if(this.isShowChecked||!i.is_show)return!1;t.navigateTo({url:"/pages/goods_details/index?id="+i.product_id})},switchTap:function(){this.isShowChecked=!this.isShowChecked},collect:function(){var t=this,i=[];if(this.visitList.forEach((function(t){t.picList.forEach((function(t){t.checked&&i.push(t.product_id)}))})),!i.length)return this.$util.Tips({title:"请选择收藏商品"});var e=i.join(",");(0,n.collectAll)(e).then((function(i){return t.$util.Tips({title:i.msg})}))},del:function(){var t=this,i=[];if(this.visitList.forEach((function(t){t.picList.forEach((function(t){t.checked&&i.push(t.product_id)}))})),!i.length)return this.$util.Tips({title:"请选择删除商品"});(0,n.deleteVisitList)({ids:i}).then((function(i){return t.times=[],t.loadend=!1,t.page=1,t.$set(t,"visitList",[]),t.get_user_visit_list(),t.$util.Tips({title:i.msg})}))},picCheckbox:function(t,i){var e=t.detail.value;this.visitList[i].picList.forEach((function(t){-1!==e.indexOf(t.id+"")?t.checked=!0:t.checked=!1})),this.visitList[i].picList.length==e.length?this.visitList[i].checked=!0:this.visitList[i].checked=!1;var s=[];this.visitList.forEach((function(t){t.checked?s.push(t.time):-1!==s.indexOf(t.time)&&s.remove(t.time)})),s.length==this.visitList.length?this.isAllSelect=!0:this.isAllSelect=!1},checkboxChange:function(t){var i=t.detail.value;this.isItemAll=i,this.visitList.forEach((function(t,e){-1!==i.indexOf(t.time)?t.checked=!0:t.checked=!1,t.picList.forEach((function(i){t.checked?i.checked=!0:i.checked=!1}))})),i.length===this.visitList.length?this.isAllSelect=!0:this.isAllSelect=!1},forGoods:function(t){this.visitList.length&&this.visitList.forEach((function(i){i.checked=!!t,i.picList.forEach((function(i){i.checked=!!t}))}))},checkboxAllChange:function(t){var i=t.detail.value;i.length?(this.isAllSelect=!0,this.forGoods(1)):(this.isAllSelect=!1,this.forGoods(0))},authColse:function(t){this.isShowAuth=t},get_user_visit_list:function(){var t=this,i=this;this.loading||this.loadend||(i.loading=!0,i.loadTitle="",(0,n.getVisitList)({page:i.page,limit:i.limit}).then((function(e){t.count=e.data.count;for(var s=0;s<e.data.time.length;s++)-1==t.times.indexOf(e.data.time[s])&&(t.times.push(e.data.time[s]),t.visitList.push({time:e.data.time[s],picList:[]}));for(var n=0;n<t.times.length;n++){t.visitList[n].checked=!!t.isAllSelect;for(var o=0;o<e.data.list.length;o++)t.times[n]===e.data.list[o].time_key&&(t.isAllSelect?e.data.list[o].checked=!0:e.data.list[o].checked=!1,t.visitList[n].picList.push(e.data.list[o]))}var c=e.data.list.length<i.limit;i.loadend=c,i.loadTitle=c?i.$t("没有更多内容啦~"):i.$t("加载更多"),i.page=i.page+1,i.loading=!1})).catch((function(t){i.loading=!1,i.loadTitle=i.$t("加载更多")})))},get_host_product:function(){var t=this;t.hotScroll||(0,n.getProductHot)(t.hotPage,t.hotLimit).then((function(i){t.hotPage++,t.hotScroll=i.data.length<t.hotLimit,t.hostProduct=t.hostProduct.concat(i.data)}))}},onReachBottom:function(){this.visitList.length?this.get_user_visit_list():this.get_host_product()},onPageScroll:function(i){t.$emit("scroll")}};i.default=a}).call(this,e("543d")["default"])},ae23:function(t,i,e){"use strict";(function(t,i){var s=e("4ea4");e("248d");s(e("66fd"));var n=s(e("353b"));t.__webpack_require_UNI_MP_PLUGIN__=e,i(n.default)}).call(this,e("bc2e")["default"],e("543d")["createPage"])},ff6a:function(t,i,e){}},[["ae23","common/runtime","common/vendor"]]]);