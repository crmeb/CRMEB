require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/users/user_invoice_form/index"],{"03de":function(e,t,n){"use strict";(function(e,t){var i=n("4ea4");n("248d");i(n("66fd"));var o=i(n("1f0c"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(o.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},"1f0c":function(e,t,n){"use strict";n.r(t);var i=n("4c0f"),o=n("d0e6");for(var a in o)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(a);n("aa7c");var r=n("f0c5"),s=Object(r["a"])(o["default"],i["b"],i["c"],!1,null,"39743e06",null,!1,i["a"],void 0);t["default"]=s.exports},"44ed":function(e,t,n){},"4c0f":function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){}));var i=function(){var e=this,t=e.$createElement,n=(e._self._c,e.$t("抬头类型")),i=e.$t("个人"),o=e.$t("企业"),a=e.$t("发票类型"),r="2"===e.type&&"2"===e.header_type?e.$t("增值税电子专用发票"):null,s="2"!==e.type||"2"!==e.header_type?e.$t("增值税电子普通发票"):null,c=e.$t("发票抬头"),d="1"===e.header_type?e.$t("需要开具发票的姓名"):null,u="1"!==e.header_type?e.$t("需要开具发票的企业名称"):null,l=e.$t("税号"),f=e.$t("纳税人识别号"),h=e.$t("手机号"),p=e.$t("您的手机号"),m=e.$t("邮箱"),_=e.$t("您的联系邮箱"),y=e.$t("开户银行"),$=e.$t("您的开户银行"),v=e.$t("银行账号"),w=e.$t("您的银行账号"),T=e.$t("企业地址"),b=e.$t("您所在的企业地址"),g=e.$t("企业电话"),k=e.$t("您的企业电话"),x=e.is_default.length,I=e.$t("设置为默认抬头"),N=e.$t("保存"),L=e.$t("取消"),Q=e.$t("发票类型选择"),P=e.__map(e.invoiceTypeList,(function(t,n){var i=e.__get_orig(t),o="1"===t.value||"2"===t.value&&e.specialInvoice?e.$t(t.name):null,a="1"===t.value||"2"===t.value&&e.specialInvoice?e.$t(t.info):null;return{$orig:i,m27:o,m28:a}}));e.$mp.data=Object.assign({},{$root:{m0:n,m1:i,m2:o,m3:a,m4:r,m5:s,m6:c,m7:d,m8:u,m9:l,m10:f,m11:h,m12:p,m13:m,m14:_,m15:y,m16:$,m17:v,m18:w,m19:T,m20:b,m21:g,m22:k,g0:x,m23:I,m24:N,m25:L,m26:Q,l0:P}})},o=[]},"65ba":function(e,t,n){"use strict";(function(e){var i=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n("8ba8"),a=i(n("66ca")),r={components:{home:function(){Promise.all([n.e("common/vendor"),n.e("components/home/index")]).then(function(){return resolve(n("03ff"))}.bind(null,n)).catch(n.oe)}},mixins:[a.default],data:function(){return{invoiceTypeList:[{name:this.$t("增值税电子普通发票"),value:"1",info:this.$t("纸质发票开出后将以邮寄形式交付")},{name:this.$t("增值税电子专用发票"),value:"2",info:this.$t("纸质发票开出后将以邮寄形式交付")}],id:"",header_type:"1",type:"1",drawer_phone:"",name:"",duty_number:"",tell:"",address:"",bank:"",card_number:"",is_default:[],email:"",popupType:!1,typeName:"",urlQuery:"",from:"",specialInvoice:!0,order_id:""}},computed:{backUrl:function(){switch(this.from){case"order_confirm":return"/pages/goods/order_confirm/index".concat(this.urlQuery);default:return"/pages/users/user_invoice_list/index?from=invoice_form"}}},onHide:function(){this.from=""},onLoad:function(t){var n=this;for(var i in t.id&&e.setNavigationBarTitle({title:"编辑发票"}),t)switch(i){case"couponTitle":case"new":case"cartId":case"pinkId":case"couponId":case"addressId":this.urlQuery+="".concat(this.urlQuery?"&":"?").concat(i,"=").concat(t[i]);break;case"from":this.from=t[i];break;case"header_type":this.header_type=t[i];break;case"id":this.id=t[i],this.getInvoiceDetail();break;case"specialInvoice":"false"===t[i]&&(this.specialInvoice=!1);break}t.order_id&&(this.order_id=t.order_id);var o=this.invoiceTypeList.find((function(e){return e.value===n.type}));this.typeName=o.name},methods:{getInvoiceDetail:function(){var t=this;e.showLoading({title:this.$t("加载中")}),(0,o.invoiceDetail)(this.id).then((function(n){e.hideLoading(),t.header_type=n.data.header_type.toString(),t.type=n.data.type.toString();var i=t.invoiceTypeList.find((function(e){return e.value===t.type}));t.typeName=i.name,t.name=n.data.name,t.drawer_phone=n.data.drawer_phone,t.email=n.data.email,t.duty_number=n.data.duty_number,t.bank=n.data.bank,t.card_number=n.data.card_number,t.address=n.data.address,t.tell=n.data.tell,t.is_default=n.data.is_default?[""]:[]})).catch((function(t){e.showToast({title:t,icon:"none"})}))},formSubmit:function(t){var n=this,i=this,a=t.detail.value;if(a.type=this.type,"1"===a.header_type){if(!a.name)return e.showToast({title:i.$t("请输入需要开具发票的姓名"),icon:"none"});if(!a.drawer_phone)return e.showToast({title:i.$t("请输入您的手机号"),icon:"none"});if(!/^1(3|4|5|7|8|9|6)\d{9}$/i.test(a.drawer_phone))return e.showToast({title:i.$t("请正确输入您的手机号"),icon:"none"});if(!a.email)return e.showToast({title:i.$t("请输入您的联系邮箱"),icon:"none"});if(!/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(a.email))return e.showToast({title:i.$t("请正确输入您的联系邮箱"),icon:"none"})}if("2"===a.header_type){if("1"===a.type){if(!a.name)return e.showToast({title:i.$t("请输入需要开具发票的企业名称"),icon:"none"});if(!a.duty_number)return e.showToast({title:i.$t("请输入纳税人识别号"),icon:"none"});if(!/[0-9A-HJ-NPQRTUWXY]{2}\d{6}[0-9A-HJ-NPQRTUWXY]{10}/.test(a.duty_number))return e.showToast({title:i.$t("请正确输入纳税人识别号"),icon:"none"});if(!a.drawer_phone)return e.showToast({title:i.$t("请输入您的手机号"),icon:"none"});if(!/^1(3|4|5|7|8|9|6)\d{9}$/i.test(a.drawer_phone))return e.showToast({title:i.$t("请正确输入您的手机号"),icon:"none"});if(!a.email)return e.showToast({title:i.$t("请输入您的联系邮箱"),icon:"none"});if(!/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(a.email))return e.showToast({title:i.$t("请正确输入您的联系邮箱"),icon:"none"})}if("2"===a.type){if(!a.name)return e.showToast({title:i.$t("请输入需要开具发票的企业名称"),icon:"none"});if(!a.duty_number)return e.showToast({title:i.$t("请输入纳税人识别号"),icon:"none"});if(!/[0-9A-HJ-NPQRTUWXY]{2}\d{6}[0-9A-HJ-NPQRTUWXY]{10}/.test(a.duty_number))return e.showToast({title:i.$t("请正确输入纳税人识别号"),icon:"none"});if(!a.drawer_phone)return e.showToast({title:i.$t("请输入您的手机号"),icon:"none"});if(!/^1(3|4|5|7|8|9|6)\d{9}$/i.test(a.drawer_phone))return e.showToast({title:i.$t("请正确输入您的手机号"),icon:"none"});if(!a.email)return e.showToast({title:i.$t("请输入您的联系邮箱"),icon:"none"});if(!/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(a.email))return e.showToast({title:i.$t("请正确输入您的联系邮箱"),icon:"none"});if(!a.bank)return e.showToast({title:i.$t("请输入您的开户银行"),icon:"none"});if(!a.card_number)return e.showToast({title:i.$t("请输入您的银行账号"),icon:"none"});if(!/^\d{16}|\d{19}$/.test(a.card_number))return e.showToast({title:i.$t("请正确输入您的银行账号"),icon:"none"});if(!a.address)return e.showToast({title:i.$t("请输入您所在的企业地址"),icon:"none"});if(!a.tell)return e.showToast({title:i.$t("请输入您的企业电话"),icon:"none"})}}a.is_default=a.is_default.length,a.id=this.id,e.showLoading({title:i.$t("保存中")}),(0,o.invoiceSave)(a).then((function(t){e.showToast({title:t.msg,icon:"success"}),setTimeout((function(o){switch(i.from){case"order_confirm":i.id?e.navigateTo({url:"/pages/goods/order_confirm/index".concat(i.urlQuery,"&invoice_id=").concat(i.id,"&invoice_type=").concat(a.type,"&header_type=").concat(n.header_type)}):e.navigateTo({url:"/pages/goods/order_confirm/index".concat(i.urlQuery,"&invoice_id=").concat(t.data.id,"&invoice_type=").concat(a.type,"&header_type=").concat(n.header_type)});break;case"order_details":i.id?e.navigateTo({url:"/pages/goods/order_details/index?order_id=".concat(i.order_id,"&invoice_id=").concat(i.id,"&header_type=").concat(n.header_type)}):e.navigateTo({url:"/pages/goods/order_details/index?order_id=".concat(i.order_id,"&invoice_id=").concat(t.data.id,"&header_type=").concat(n.header_type)});break;default:e.navigateTo({url:"/pages/users/user_invoice_list/index?from=invoice_form"});break}}),1e3)})).catch((function(t){e.showToast({title:t,icon:"none"})}))},callType:function(){2==this.header_type?this.popupType=!0:e.showToast({title:this.$t("个人仅支持普通发票"),icon:"none"})},changeType:function(e){var t=e.detail.value,n=this.invoiceTypeList.find((function(e){return e.value===t}));"2"===t&&"1"===this.header_type&&(this.header_type="2"),this.typeName=n.name,this.type=t,this.popupType=!1},closeType:function(){this.popupType=!1},changeTitleType:function(e){this.header_type=e.detail.value,this.type="1"}}};t.default=r}).call(this,n("543d")["default"])},aa7c:function(e,t,n){"use strict";var i=n("44ed"),o=n.n(i);o.a},d0e6:function(e,t,n){"use strict";n.r(t);var i=n("65ba"),o=n.n(i);for(var a in i)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(a);t["default"]=o.a}},[["03de","common/runtime","common/vendor"]]]);